<%
# =====================================================================
# Project:       QuestaSim waves
# Title:         cl_acc_intf.template_wave_do
# Description:   QuestaSim waves of cluster accelerator interface.
#
# $Date:         29.12.2021
#
# Generator:     generate_ov_test
# ===================================================================== */
#
# Copyright (C) 2021 University of Modena and Reggio Emilia.
#
# Author: Gianluca Bellocchi, University of Modena and Reggio Emilia.
%>

<%
# =====================================================================
# Title:        vsim_waves_ov_acc_intf
# Type:         Template API
# Description:  Cluster accelerator interface
# =====================================================================
%>

<%def name="vsim_waves_lic_acc_region(n_acc_cl)">\

% if (n_acc_cl>0):

add wave -noupdate -group {pulp_cluster[${cl_id}]} -group {accelerators} -group {lic_acc_region} -group {top} {/overlay_tb/dut/gen_clusters[${cl_id}]/gen_cluster_sync/i_cluster/i_ooc/i_bound/lic_acc_region_gen/lic_acc_region_i/*}

add wave -noupdate -group {pulp_cluster[${cl_id}]} -group {accelerators} -group {lic_acc_region} -group {events} -label {cl_event} {/overlay_tb/dut/gen_clusters[${cl_id}]/gen_cluster_sync/i_cluster/i_ooc/i_bound/lic_acc_region_gen/lic_acc_region_i/evt_o}
add wave -noupdate -group {pulp_cluster[${cl_id}]} -group {accelerators} -group {lic_acc_region} -group {events} -label {acc_event} {/overlay_tb/dut/gen_clusters[${cl_id}]/gen_cluster_sync/i_cluster/i_ooc/i_bound/lic_acc_region_gen/lic_acc_region_i/hwpe_evt}

  <%
    mst_port_offset_L = 0
    mst_port_offset_H = 0
  %>

  % for acc_offset in range(n_acc_cl):

    <%
      if (cl_lic_acc_protocols[acc_offset] == "hwpe"):
        if (acc_offset == 0):
          mst_port_offset_L = 0
          mst_port_offset_H = cl_lic_acc_n_data_ports[acc_offset] - 1
        else:
          mst_port_offset_L = cl_lic_acc_n_data_ports[acc_offset-1] + mst_port_offset_L
          mst_port_offset_H = cl_lic_acc_n_data_ports[acc_offset] + mst_port_offset_H
    %>

    % for port_offset in range(mst_port_offset_L, mst_port_offset_H+1):
add wave -noupdate -group {pulp_cluster[${cl_id}]} -group {accelerators} -group {lic_acc_region} -group {wrapper[${acc_offset}]} -group {hwpe_xbar_master[${port_offset}]} {/overlay_tb/dut/gen_clusters[${cl_id}]/gen_cluster_sync/i_cluster/i_ooc/i_bound/lic_acc_region_gen/lic_acc_region_i/hwpe_xbar_master[${port_offset}]/*}
    % endfor

add wave -noupdate -group {pulp_cluster[${cl_id}]} -group {accelerators} -group {lic_acc_region} -group {wrapper[${acc_offset}]} -group {hwpe_cfg_slave[${acc_offset}]} {/overlay_tb/dut/gen_clusters[${cl_id}]/gen_cluster_sync/i_cluster/i_ooc/i_bound/lic_acc_region_gen/lic_acc_region_i/hwpe_cfg_slave[${acc_offset}]/*}
  % endfor

% endif

</%def>